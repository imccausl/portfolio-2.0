"use strict";!function(e,t){function n(){console.log("Building the menu!");var e,n,o=i.getResumeSections(),a=1,r="";for(console.log(o);a<o.length;a++)e="#"+o[a].id,r=o[a].children[0].textContent,console.log("section name:",r),n='<li class="col-xs-12"><a href="'+e+'">'+r+"</a></li>",t("#r-jump-menu-items").append(n)}function o(){var e=t("#r-jump-menu"),n=t("#r-nav-icon");n.hasClass(l.navMenu.open)?(e.hide().animate({height:"toggle"}),n.removeClass(l.navMenu.open),n.addClass(l.navMenu.close)):(e.show().animate({height:"toggle"}),n.removeClass(l.navMenu.close),n.addClass(l.navMenu.open))}function a(){console.log(l.templates)}function r(){t("#r-nav-menu").on("click",function(e){e.preventDefault(),o()}),t("#login").on("click",function(e){e.preventDefault(),console.log("Hello?")}),t("#edit-mode--save-button").on("click",function(e){a()}),t(e).on("click",function(e){})}var i={convertDataTypeName:function(e){e=e.split("-");for(var t=1;t<e.length;t++)e[t]=e[t].replace(e[t].charAt(0),e[t].charAt(0).toUpperCase());return e=e.join("")},getResumeSections:function(){var t=e.getElementsByTagName("section");return t},convertMonth:function(e){return console.log("Convert month:",e),e=e.split("/"),e.reverse(),e=e.join("-"),console.log("Month converted:",e),e}},l={path:"http://api.ianmccausland.xyz:8080/v1/resumes?metadata.isPublic=true",resume:{},header:{},templates:[],sectionHeaders:'<h3 class="text-capitalize">{{modifyHeader}}{{this.title}}</h3>',navMenu:{open:"fa-chevron-down",close:"fa-chevron-up"},get:function(e){return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("GET",e),o.onload=function(){200===o.status?t(o.response):n(o.status)},o.onerror=function(){n("Network error")},o.send()})}},s={init:function(){var e,o=new Date;console.log("Initializing the view!"),l.resume.experience.content=s.sortData(l.resume.experience.content,"start"),l.resume.volunteerExperience.content=s.sortData(l.resume.volunteerExperience.content,"start"),Handlebars.registerPartial("sectionHeader",l.sectionHeaders),e=t("#r-experience-partial").html(),Handlebars.registerPartial("experiencePartial",e),console.log("Registering nav menu template partial!"),e=t("#r-nav-template").html(),Handlebars.registerPartial("navMenu",e),console.log("Putting current year in the footer",o.getFullYear()+"!"),t("#r-copyright").html(o.getFullYear()),c.getTemplateHTML(),console.log("model.resume.info",l.resume.info),l.resume.info.img="./images/bio.jpg",c.buildHeader(l.resume.info),c.buildResume(),c.buildFooter(l.resume.info.socialFeed),n(),r()},sortData:function(e,t){return e.sort(function(e,n){return n[t].substr(3)-e[t].substr(3)})}},c={init:function(){l.get(l.path).then(function(e){l.resume=JSON.parse(e)[0],console.log(JSON.parse(e)[0])}).then(function(e){s.init()}).catch(function(e){console.log(e)})},buildHeader:function(e){var n;n=t("#r-header").html(),l.header=Handlebars.compile(n),t("#r-header-view").append(l.header(e))},buildFooter:function(e){var n,o=t("#r-footer--social").html();n=Handlebars.compile(o),t("#r-footer--socialview").html(n(e))},buildResume:function(){l.templates.forEach(function(e){console.log(e.dataType),t("#r-body-view").append(e.template(l.resume[e.dataType]))})},buildNavigation:function(){},compileTemplate:function(e){return Handlebars.compile(e.innerHTML)},getTemplateHTML:function(){var t=e.querySelectorAll(".r-templates");l.templates=[];var n=null;t.forEach(function(e){n=e.getAttribute("data-type"),l.templates.push({dataType:i.convertDataTypeName(n),template:c.compileTemplate(e)})}),console.log(l.templates)}};c.init()}(document,jQuery);